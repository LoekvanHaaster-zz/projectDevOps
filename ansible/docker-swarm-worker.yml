---
- hosts: workers

  vars:
    default_save_path: /home/Zilk/vars.yml
    own_ip: "{{ ansible_facts.eth0.ipv4.address }}"

  tasks:
    - name: copy vars.yml to workers
      copy:
        src: /home/Loek/manager-01/home/Zilk/vars.yml
        dest: "{{ default_save_path }}"
    
    - name: Include vars of vars.yaml into the 'vars'
      include_vars:
        dir: /home/Loek/manager-01/home/Zilk
        file: vars.yaml
        
    - debug:
        msg: "{{ frank }}"
    
    - debug:
        msg: "{{ tiffany }}"
    
    - name: Remove potential existing swarm hosts
      docker_swarm:
        state: absent
        force: true
      become: yes

    - name: Add nodes
      docker_swarm:
        state: join
        advertise_addr: "{{ own_ip }}"
        join_token: "{{ frank }}"
        remote_addrs: "[ {{ tiffany }} ]"
      become: yes
